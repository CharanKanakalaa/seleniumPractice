<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Submit Form</title>
  <Link rel="stylesheet" href="../styles/formstyles.css">
</head>
<body>
  <main class="page">
    <h1>Submit Form</h1>

    <section class="layout">
      <!-- ===== FORM ===== -->
      <form id="studentForm" class="card" novalidate>
        <!-- First/Last Name -->
        <div class="field-row">
          <div class="field">
            <label for="firstName">First Name <span class="req">*</span></label>
            <input type="text" id="firstName" name="firstName" placeholder="Enter first name" required />
          </div>

          <div class="field">
            <label for="lastName">Last Name <span class="req">*</span></label>
            <input type="text" id="lastName" name="lastName" placeholder="Enter last name" required />
          </div>
        </div>

        <!-- Phone -->
        <div class="field">
          <label for="phone">Phone Number (10 digits) <span class="req">*</span></label>
          <input
            type="tel"
            id="phone"
            name="phone"
            placeholder="e.g., 9876543210"
            inputmode="numeric"
            maxlength="10"
            pattern="^\d{10}$"
            title="Please enter exactly 10 digits."
            required
          />
        </div>

        <!-- Branch -->
        <div class="field">
          <label for="branch">Branch <span class="req">*</span></label>
          <select id="branch" name="branch" required>
            <option value="" selected disabled>-- Select Branch --</option>
            <option value="CSE">CSE</option>
            <option value="ECE">ECE</option>
            <option value="EEE">EEE</option>
            <option value="MECH">MECH</option>
            <option value="AI">AI</option>
            <option value="DS">DS</option>
            <option value="Others">Others</option>
          </select>
        </div>

        <!-- Gender -->
        <fieldset class="field">
          <legend>Gender <span class="req">*</span></legend>
          <label class="choice">
            <input type="radio" name="gender" value="Male" required />
            <span>Male</span>
          </label>
          <label class="choice">
            <input type="radio" name="gender" value="Female" required />
            <span>Female</span>
          </label>
        </fieldset>

        <!-- Sports (Checkboxes) -->
        <fieldset class="field">
          <legend>Sports</legend>
          <div class="checkboxes">
            <label class="choice">
              <input type="checkbox" name="sports" value="Basketball" />
              <span>Basketball</span>
            </label>
            <label class="choice">
              <input type="checkbox" name="sports" value="Cricket" />
              <span>Cricket</span>
            </label>
            <label class="choice">
              <input type="checkbox" name="sports" value="Volleyball" />
              <span>Volleyball</span>
            </label>
          </div>
          <div id="sportsError" class="error-text" aria-live="polite"></div>
        </fieldset>

        <!-- Address -->
        <div class="field">
          <label for="address">Address <span class="req">*</span></label>
          <textarea id="address" name="address" rows="3" placeholder="Enter full address" required></textarea>
        </div>

        <!-- Pincode -->
        <div class="field">
          <label for="pincode">Pincode (6 digits) <span class="req">*</span></label>
          <input
            type="text"
            id="pincode"
            name="pincode"
            placeholder="e.g., 600001"
            inputmode="numeric"
            maxlength="6"
            pattern="^\d{6}$"
            title="Please enter exactly 6 digits."
            required
          />
        </div>

        <!-- Actions -->
        <div class="actions">
          <button type="button" id="clearBtn" class="btn btn-secondary">Clear</button>
          <button type="submit" class="btn">Submit</button>
        </div>
      </form>

      <!-- ===== RESULTS PANEL (hidden initially) ===== -->
      <aside id="resultPanel" class="card side hidden" aria-live="polite">
        <h2>Selected Details</h2>
        <div id="resultContent" class="result-content">
          <!-- Filled after submit -->
        </div>
      </aside>
    </section>
  </main>

  <script>
    // Helper: get selected checkbox values as array of strings
    function getCheckedValues(name) {
      return Array.from(document.querySelectorAll('input[name="' + name + '"]:checked'))
                  .map(el => el.value);
    }

    const form = document.getElementById('studentForm');
    const resultPanel = document.getElementById('resultPanel');
    const resultContent = document.getElementById('resultContent');
    const sportsError = document.getElementById('sportsError');
    const clearBtn = document.getElementById('clearBtn');

    form.addEventListener('submit', (e) => {
      e.preventDefault();

      // Built-in validation first
      if (!form.checkValidity()) {
        form.reportValidity();
        return;
      }

      // Optional custom validation: ensure at least one sport is selected (remove if not needed)
      const sports = getCheckedValues('sports');
      if (sports.length === 0) {
        sportsError.textContent = 'Please select at least one sport.';
        const firstSport = document.querySelector('input[name="sports"]');
        if (firstSport) firstSport.focus();
        return;
      } else {
        sportsError.textContent = '';
      }

      // Gather values
      const data = {
        firstName: document.getElementById('firstName').value.trim(),
        lastName: document.getElementById('lastName').value.trim(),
        phone: document.getElementById('phone').value.trim(),
        branch: document.getElementById('branch').value,
        gender: (document.querySelector('input[name="gender"]:checked') || {}).value || '',
        sports: sports.join(', '),
        address: document.getElementById('address').value.trim(),
        pincode: document.getElementById('pincode').value.trim(),
      };

      // Render selected details
      resultContent.innerHTML = `
        <ul class="summary">
          <li><strong>Name:</strong> ${data.firstName} ${data.lastName}</li>
          <li><strong>Phone:</strong> ${data.phone}</li>
          <li><strong>Branch:</strong> ${data.branch}</li>
          <li><strong>Gender:</strong> ${data.gender}</li>
          <li><strong>Sports:</strong> ${data.sports}</li>
          <li><strong>Address:</strong> ${data.address}</li>
          <li><strong>Pincode:</strong> ${data.pincode}</li>
        </ul>
      `;

      // Reveal side panel
      resultPanel.classList.remove('hidden');
      resultPanel.scrollIntoView({ behavior: 'smooth', block: 'nearest', inline: 'start' });
    });

    // Clear button: reset form, hide results, clear errors
    clearBtn.addEventListener('click', () => {
      form.reset();
      sportsError.textContent = '';
      resultPanel.classList.add('hidden');
      resultContent.innerHTML = '';
      document.getElementById('firstName').focus();
    });
  </script>
</body>
</html>